# Ozon Route 256 — Kafka Homework

### Docker
* Если у вас всё ещё нет docker — его нужно поставить.
* Запустить docker контейнеры (БД): `docker compose up -d`
* Остановить docker контейнеры (БД): `docker compose down`
* Остановить и почистить docker от данных: `docker compose down -v`
* Docker поломался: `docker system prune`

### Kafka
* Заводите Kafka через docker. Пример docker-compose-файла с Kafka находится в репозитории воркшопа этой недели: https://gitlab.ozon.dev/cs/classroom-6/Week-6/workshop/-/blob/master/docker-compose.yml
* Offset Explorer (ранее называлось Kafka Tool): https://www.kafkatool.com/ — позволяет читать и писать в Apache Kafka через простой UI
* Серьезные девчата и пацаны качают Kafka (https://kafka.apache.org/downloads) и используют sh/bat-файлы оттуда, чтобы читать/писать/манипулировать Кафкой. Допускается быть несерьезными и использовать Offset Explorer.

### Домашнее задание
За основу берется домашнее задание предыдущей недели, либо проект из текущего репозитория — на ваше усмотрение.

Соседняя команда Очень Важных Задач пришла к нам и попросила рассчитывать цену всех активных товаров (200+ млн) каждую ночь. Мы ох как удивились, поняли что API им не подойдёт и предложили схему:
* Создаем топик Kafka `item_price_calc_requests` с входящими параметрами, аналогичными тем, что есть в последней версии API. Дополнительно ребята добавляют ещё поле с идентификатором товара во Всем Известной Кроме Нас Системе Товаров Озона. Формат сообщений — JSON. Наполнение топика остается за командой Очень Важных Задач. Наша задача — читать этот топик и делать расчёты.
* Создаём топик Kafka `item_price_calc`, в который мы будем писать результаты расчёта вместе с идентификатором товара, чтобы связать результаты с запросом. Формат сообщений — также JSON. Чтение топика и применение этих данных для своих нужд, слава богу, сможет сделать команда Очень Важных Задач.
* Создаём топик `item_price_dlq`, в который мы будем писать невалидные сообщения, если такие будут. Разбор этого топика на стадии MVP не предполагается.

### Бонусные алмазики
* Так как команда Очень Важных Задач перегружена, то она наградит нас одним алмазиком, если мы напишем сервис, который будет наполнять топик `item_price_calc_requests` актуальными товарами. Ребята очень заняты, поэтому их устроит даже консольное приложение. Они не сказали, где брать список актуальных товаров. Вероятно, подойдет Мистер Псевдослучайный Рандом.
* Мы беспокоимся, поэтому дополнительно хотим записывать к себе в БД аномальные результаты расчётов товаров. Например, стоимость выше 10000 рублей (подберите цифру эмпирически, если сделаете первую часть задачи). Мы не хотим тормозить расчёт, поэтому применим схему асинхронного взаимодействия — создадим ещё один hosted-сервис, который читает наши же результаты расчёта и сохраняет в БД такие аномалии. За такую работу тимлид похлопает по плечу, продакт менеджер пробубнит что-то про бизнесовые метрики, а у вас появится алмазик.